!function(t,e){"use strict";"function"!=typeof Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e});var r,a,o=function(){};r=function(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},a=function(){var t,n,f={},i=[];return n=function(t,e,r){var a,o=t.created+r,n=t.created+e,f=!1;for(a=i.length-1;a>-1;a--)if(t.stream===i[a].stream&&i[a].date>=n&&i[a].date<=o){f=!0;break}return f},t={_call:function(t){var r,a,o,n,u,I=t.id,c=t.anything,l=t.propagate,m={id:I},s=f[I];s===e&&(s=f[I]=[]),r=s.length,o=1*new Date,0!==l&&(n=0>l?"upStream":"downStream",l=Math.abs(l)),(u=function(t,e){var f,N,b;if(e)for(b=0;r>b;b++)a=s[b],a.stream===t&&(a.callback(m,c),i.push({date:o,id:I,anything:c,stream:t}));if(0!==l)for(f=t[n],N=f.length,b=0;N>b;b++)u(f[b],!0)})(this,2!==l)},_when:function(t){var r,a,i,u,I=t.id,c=t.fn,l=t.now;if(l=l===e?!1:l,a=f[I]!==e,r=f[I]=f[I]||[],c)i={callback:c,stream:this,created:1*new Date,fall:t.fall||o},t.to===Number.POSITIVE_INFINITY&&0===t.from?r.push(i):t.from>t.to||(t.from<0?t.to>=0?(r.push(i),n(i,t.from,t.to)&&i.callback(),t.to!==Number.POSITIVE_INFINITY&&setTimeout(function(){i.callback=o,n(i,t.from,t.to)||i.fall()},t.to)):t.to!==Number.NEGATIVE_INFINITY&&(n(i,t.from,t.to)?i.callback():i.fall()):t.from!==Number.POSITIVE_INFINITY&&t.to>=0&&(0===t.from?r.push(i):setTimeout(function(){i.created=1*new Date,r.push(i)},t.from),t.to!==Number.POSITIVE_INFINITY&&setTimeout(function(){i.callback=o,n(i,t.from,t.to)||i.fall()},t.to)));else if(r!==e)for(u=r.length-1;u>-1;u--)r[u].stream===this&&r.splice(u,1)},"new":function(t,e){var o,n;return"string"===r(t)&&(n=t,t=e),t===!0?o=a():(o=Object.create(this),o.upStream=[this],o.downStream=[],this.downStream.push(o)),o.label=n,o}},t.upStream=[],t.downStream=[],t["if"]=t.on=t.off=t.when=function(t,e,a,n,f){var i={id:t,to:Number.POSITIVE_INFINITY,from:0,fn:o,fall:o};"boolean"===r(e)&&(e=e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),"boolean"===r(a)&&(a=a?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),"number"===r(e)&&"number"===r(a)?(i.from=e,i.to=a,e=n,a=f):"number"===r(e)&&(e>0?(i.to=e,i.from=0):(i.to=0,i.from=e),e=a,a=n),i.fn=e,i.fall=a,this._when(i)},t.trigger=t.call=t["do"]=t.fire=function(t,e,a){var o={id:t,anything:e,propagate:1};"number"===r(t)&&(o.propagate=t,o.id=e,o.anything=a),this._call(o)},t.label="root",t},t.eventstream=a()}(this);
